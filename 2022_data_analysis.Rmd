---
title: "Gun cases per day"
author: "Micah Clark Moody"
date: "3/2/2022"
output: html_document
---

# Load required packages
```{r setup}
library(tidyverse)
library(lubridate)
library(knitr)
```

# Import and clean data
- make import reproducible (get rid of desktop path)
- in .csv remove ASA, atty, and columns after "notes"
```{r} 
# importing data
data <- read.csv("~/Desktop/r/bond_court/2022 Data (original)/data_cleaned.csv")

data$can_post <- as.numeric(data$can_post) 

data$bond_amount <- as.numeric(data$bond_amount)

test <- data %>%
  select(date, case, judge, can_post, bond_amount, bond_type) %>%
  filter(bond_type == "D") %>%
  drop_na() %>%
  mutate("bond_excess" = ifelse(((can_post * 10) < bond_amount), 1, 0))

data <- left_join(data, test)
```

# Breaking down data by judge
## Bond type for each judge
```{r}
judges <- data %>%
  filter(judge != "?", bond_type != "") %>%
  group_by(bond_type, judge) %>%
  summarize(n())

judge_total <- data %>%
  filter(judge != "?", bond_type != "") %>%
  group_by(judge) %>%
  summarise(n()) %>%
  rename("total_cases" = "n()")

judges <- full_join(judges, judge_total) %>%
  mutate("percent" = `n()` / `total_cases`)

ggplot(judges, mapping = aes(
  x = bond_type,
  y = `percent`
)) +
  geom_col() +
  scale_y_continuous(labels = scales::percent) +
  facet_wrap(facets = "judge") + 
  labs(
    title = "Percentage of Bond Type by Judge",
    x = "Bond Type",
    y = "Percentage of Total Bonds"
  )

kable(judge_total)
```

## Excessive bond for each judge
```{r}
```

